<tool id="retip" name="Retip" version="{{tool_version}}">
	<description>is Retention Time Prediction for Metabolomics</description>
    <requirements>
      <container type="docker">{{container_registry}}:{{tool_version}}</container>
    </requirements>
	<command detect_errors="exit_code"><![CDATA[
	     #if $inputdata.type_selector == "descriptors"
            echo "Processing Descriptors..."
            && /run.sh chemdesc.R '$inputdata.compounds' '$output_file1'
         #else if $inputdata.type_selector == "train"
            echo "Processing Train..."
            && /run.sh trainKeras.R '$inputdata.descr_train' '$output_file2'
         #else
           echo "Processing Apply..."
           && /run.sh oneSmiles.R '$inputdata.descr_train' '$inputdata.model_hdf5' '$output_file3'
         #end if
      ]]>
    </command>
	<inputs>
        <conditional name="inputdata">
            <param name="type_selector" type="select" label="Select an input function">
                <option value="descriptors" selected="true">Compute Chemical Descriptors</option>
                <option value="train">Train Keras Model</option>
                <option value="apply">Apply Keras Model to Single SMILES</option>
            </param>
            <when value="descriptors">
                <param name="compounds" label="Select Compounds Dataset" type="data" format="tabular" optional="false"/>
            </when>
            <when value="train">
                <param name="descr_train" label="Select Descriptors.Feather Dataset" type="data" format="feather" optional="false"/>
            </when>
            <when value="apply">
                <param name="descr_train" label="Select Descriptors.Feather Dataset" type="data" format="feather" optional="false"/>
                <param name="model_hdf5" label="Select Model.hdf5 Dataset" type="data" format="h5" optional="false"/>
            </when>
        </conditional>
	</inputs>
    <outputs>
        <data format="feather" name="output_file1" label="Descriptors.Feather Dataset" from_work_dir="">
          <filter>inputdata['type_selector'] == 'descriptors'</filter>
        </data>
        <data format="h5" name="output_file2" label="Model.hdf5 Dataset" from_work_dir="">
          <filter>inputdata['type_selector'] == 'train'</filter>
        </data>
        <data format="smi" name="output_file3" label="SMILES Dataset" from_work_dir="">
          <filter>inputdata['type_selector'] == 'apply'</filter>
        </data>
    </outputs>
    <help>Retention Time Prediction for Metabolomics.</help>
</tool>